<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Unstratified and Stratified Miettinen and Nurminen Test • metalite.ae</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Unstratified and Stratified Miettinen and Nurminen Test">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metalite.ae</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/metalite-ae.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Merck/metalite.ae/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Unstratified and Stratified Miettinen and Nurminen Test</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Merck/metalite.ae/blob/v0.1.3/vignettes/rate-compare.Rmd" class="external-link"><code>vignettes/rate-compare.Rmd</code></a></small>
      <div class="d-none name"><code>rate-compare.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Binary outcome is a commonly used endpoint in clinical trials. This
page illustrates how to conduct the unstratified or stratified analysis
with the Miettinen and Nurminen (M&amp;N) method <span class="citation">(Miettinen and Nurminen 1985)</span> for risk
difference analysis in R. The following statistics can be calculated
with the function <code><a href="../reference/rate_compare.html">rate_compare()</a></code>:</p>
<ul>
<li>Estimated risk difference.</li>
<li>Test statistic.</li>
<li>Confidence interval for the risk difference.</li>
<li>p-value for risk difference.</li>
</ul>
</div>
<div class="section level2">
<h2 id="statistical-methods">Statistical methods<a class="anchor" aria-label="anchor" href="#statistical-methods"></a>
</h2>
<div class="section level3">
<h3 id="unstratified-analysis-of-mn-method">Unstratified analysis of M&amp;N method<a class="anchor" aria-label="anchor" href="#unstratified-analysis-of-mn-method"></a>
</h3>
<p>Assume the data includes two independent binomial samples with binary
response variables to be analyzed/summarized and the data collected in a
clinical design without stratification. Also this approach is applicable
to the case when the data are collected using a stratified clinical
design and the statistician would like to ignore stratification by
pooling the data over strata assuming two independent binomial samples.
Assume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>i</mi></msub><annotation encoding="application/x-tex">P_i</annotation></semantics></math>
is the proportion of success responses in the test
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i=1</annotation></semantics></math>)
or control
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">i=0</annotation></semantics></math>)
group.</p>
<div class="section level4">
<h4 id="confidence-interval">Confidence interval<a class="anchor" aria-label="anchor" href="#confidence-interval"></a>
</h4>
<p>The confidence interval is based on the M&amp;N method and given by
the roots for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>D</mi><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mo>−</mo><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">PD=P_1-P_0</annotation></semantics></math>
of the equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>χ</mi><mi>α</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><mo>−</mo><mi>P</mi><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mover><mi>V</mi><mo accent="true">̃</mo></mover></mfrac></mrow><annotation encoding="application/x-tex">\chi_\alpha^2 = \frac{(\hat{p}_1-\hat{p}_0-PD)^2}{\tilde{V}}</annotation></semantics></math>,</p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><annotation encoding="application/x-tex">\hat{p}_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><annotation encoding="application/x-tex">\hat{p}_0</annotation></semantics></math>
are the observed values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>1</mn></msub><annotation encoding="application/x-tex">P_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>0</mn></msub><annotation encoding="application/x-tex">P_0</annotation></semantics></math>,
respectively;</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>χ</mi><mi>α</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\chi_\alpha^2</annotation></semantics></math>
= the upper cut point of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
from the central chi-square distribution with 1 degree of freedom
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>χ</mi><mi>α</mi><mn>2</mn></msubsup><mo>=</mo><mn>3.84</mn></mrow><annotation encoding="application/x-tex">\chi_\alpha^2 = 3.84</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>95</mn><annotation encoding="application/x-tex">95</annotation></semantics></math>%
confidence interval);</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">PD</annotation></semantics></math>
= the difference between two population proportions
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>D</mi><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mo>−</mo><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">PD=P_1-P_0</annotation></semantics></math>);</p></li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>V</mi><mo accent="true">̃</mo></mover><mo>=</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">[</mo><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mi>n</mi><mn>0</mn></msub></mfrac><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">]</mo><mfrac><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>0</mn></msub></mrow><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>0</mn></msub><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\tilde{V}=\bigg[\frac{\tilde{p}_1(1-\tilde{p}_1)}{n_1}+
\frac{\tilde{p}_0(1-\tilde{p}_0)}{n_0}\bigg]\frac{n_1+n_0}{n_1+n_0-1}</annotation></semantics></math>;</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>1</mn></msub><annotation encoding="application/x-tex">n_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>0</mn></msub><annotation encoding="application/x-tex">n_0</annotation></semantics></math>
are the sample sizes for the test and control group,
respectively;</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>1</mn></msub><annotation encoding="application/x-tex">\tilde{p}_1</annotation></semantics></math>
= maximum likelihood estimate of proportion on test computed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>0</mn></msub><mo>+</mo><mi>P</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">\tilde{p}_0+PD</annotation></semantics></math>;</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>0</mn></msub><annotation encoding="application/x-tex">\tilde{p}_0</annotation></semantics></math>
= maximum likelihood estimate of proportion on control under the
constraint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>1</mn></msub><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>0</mn></msub><mo>=</mo><mi>P</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">\tilde{p}_1-\tilde{p}_0=PD</annotation></semantics></math>.</p></li>
</ul>
<p>As stated above the 2-sided
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">100(1-\alpha)</annotation></semantics></math>%
CI is given by the roots for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>D</mi><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mo>−</mo><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">PD=P_1-P_0</annotation></semantics></math>.
The bisection algorithm is used in the function to obtain the two roots
(confidence interval) for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">PD</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="p-value-and-z-statistic">p-value and Z-statistic<a class="anchor" aria-label="anchor" href="#p-value-and-z-statistic"></a>
</h4>
<p>The Z-statistic is computed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mtext mathvariant="normal">diff</mtext></msub><mo>=</mo><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><mo>+</mo><msub><mi>S</mi><mn>0</mn></msub></mrow><msqrt><mover><mi>V</mi><mo accent="true">̃</mo></mover></msqrt></mfrac></mrow><annotation encoding="application/x-tex">Z_\text{diff}=\frac{\hat{p}_1-\hat{p}_0+S_0}{\sqrt{\tilde{V}}}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><annotation encoding="application/x-tex">\hat{p}_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><annotation encoding="application/x-tex">\hat{p}_0</annotation></semantics></math>
are the observed values for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>1</mn></msub><annotation encoding="application/x-tex">P_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>0</mn></msub><annotation encoding="application/x-tex">P_0</annotation></semantics></math>
respectively,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mn>0</mn></msub><annotation encoding="application/x-tex">S_0</annotation></semantics></math>
is pre-specified proportion difference under the null;</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>1</mn></msub><annotation encoding="application/x-tex">\tilde{p}_1</annotation></semantics></math>
= maximum likelihood estimate of proportion on test computed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>0</mn></msub><mo>+</mo><msub><mi>S</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\tilde{p}_0+S_0</annotation></semantics></math>;</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>0</mn></msub><annotation encoding="application/x-tex">\tilde{p}_0</annotation></semantics></math>
= maximum likelihood estimate of proportion on control under the
constraint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>1</mn></msub><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mn>0</mn></msub><mo>=</mo><msub><mi>S</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\tilde{p}_1-\tilde{p}_0=S_0</annotation></semantics></math>.</p></li>
<li><p>For non-inferiority or one-sided equivalence hypothesis with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">S_0&gt;0</annotation></semantics></math>,
the p-value,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>≥</mo><msub><mi>Z</mi><mtext mathvariant="normal">diff</mtext></msub><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Pr(Z \geq Z_\text{diff} \, | \, H_0)</annotation></semantics></math>,
is computed based on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mtext mathvariant="normal">diff</mtext></msub><annotation encoding="application/x-tex">Z_\text{diff}</annotation></semantics></math>
using the standard normal distribution.</p></li>
<li><p>For non-inferiority or one-sided equivalence hypothesis with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">S_0&lt;0</annotation></semantics></math>,
the p-value,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>≤</mo><msub><mi>Z</mi><mtext mathvariant="normal">diff</mtext></msub><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Pr(Z \leq Z_\text{diff} \, | \, H_0)</annotation></semantics></math>,
is computed based on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mtext mathvariant="normal">diff</mtext></msub><annotation encoding="application/x-tex">Z_\text{diff}</annotation></semantics></math>
using the standard normal distribution.</p></li>
<li><p>For two-sided superiority test, the p-value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>χ</mi><mtext mathvariant="normal">diff</mtext><mn>2</mn></msubsup><mo>≤</mo><msubsup><mi>χ</mi><mn>1</mn><mn>2</mn></msubsup><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Pr(\chi_\text{diff}^2 \leq \chi_1^2 \, | \, H_0)</annotation></semantics></math>,
is computed based on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>χ</mi><mtext mathvariant="normal">diff</mtext><mn>2</mn></msubsup><annotation encoding="application/x-tex">\chi_\text{diff}^2</annotation></semantics></math>
using the chi-square distribution with 1 degree of freedom, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>χ</mi><mtext mathvariant="normal">diff</mtext><mn>2</mn></msubsup><mo>=</mo><msubsup><mi>Z</mi><mtext mathvariant="normal">diff</mtext><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\chi_\text{diff}^2=Z_\text{diff}^2</annotation></semantics></math>.</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="stratified-analysis-of-mn-method">Stratified analysis of M&amp;N method<a class="anchor" aria-label="anchor" href="#stratified-analysis-of-mn-method"></a>
</h3>
<p>Assume the data includes two treatment groups, test and control, and
collected based on a stratified design. Within each stratum there are
two independent binomial samples with binary response variables to be
analyzed/summarized. The parameter of interest is the difference between
the population proportions of the test and the control groups. The
analysis and summaries need to be performed while adjusting for the
stratifying variables.</p>
<div class="section level4">
<h4 id="confidence-interval-1">Confidence interval<a class="anchor" aria-label="anchor" href="#confidence-interval-1"></a>
</h4>
<p>The confidence interval is based on the M&amp;N method and given by
the roots for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>D</mi><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mo>−</mo><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">PD=P_1-P_0</annotation></semantics></math>
of the equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>χ</mi><mi>α</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>1</mn><mo>*</mo></msubsup><mo>−</mo><msubsup><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>0</mn><mo>*</mo></msubsup><mo>−</mo><mi>P</mi><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>W</mi><mi>i</mi></msub><mi>/</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>W</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msub><mover><mi>V</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\chi_\alpha^2 = \frac{(\hat{p}_1^*-\hat{p}_0^*-PD)^2}{\sum_{i=1}^I(W_i/\sum_{k=1}^{K}W_k)^2\tilde{V}_i}</annotation></semantics></math>,</p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>p</mi><mo accent="true">̂</mo></mover><mi>s</mi><mo>*</mo></msubsup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>W</mi><mi>i</mi></msub><mi>/</mi><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>W</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mi>s</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{p}_s^* = \sum_{i=1}^I(W_i/\sum_{k=1}^KW_k)\hat{p}_{s i}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s = 0, 1</annotation></semantics></math>;</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>V</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mo>=</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">[</mo><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>1</mn><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mi>n</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub></mfrac><mo>+</mo><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>0</mn><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mi>n</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub></mfrac><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">]</mo><mfrac><mrow><msub><mi>n</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>n</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub></mrow><mrow><msub><mi>n</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>n</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\tilde{V}_i=\bigg[\frac{\tilde{p}_{1i}(1-\tilde{p}_{1i})}{n_{1i}}+\frac{\tilde{p}_{0i}(1-\tilde{p}_{0i})}{n_{0i}}\bigg]\frac{n_{1i}+n_{0i}}{n_{1i}+n_{0i}-1}</annotation></semantics></math>;</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mi>i</mi></msub><annotation encoding="application/x-tex">W_i</annotation></semantics></math>
is the weight for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
strata;</li>
<li>$I = K = $ number of strata,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>k</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">i=k=</annotation></semantics></math>
strata;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">n_{1i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">n_{0i}</annotation></semantics></math>
are the sample sizes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
strata for the test and control group, respectively;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\hat{p}_{1i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\hat{p}_{0i}</annotation></semantics></math>
= observed proportion in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
strata for the test and control, respectively;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\tilde{p}_{0i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\tilde{p}_{1i}</annotation></semantics></math>
are MLE for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">P_{0i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">P_{1i}</annotation></semantics></math>,
respectively, computed under the constraint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>=</mo><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>+</mo><mi>P</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">\tilde{p}_{1i}=\tilde{p}_{0i}+PD</annotation></semantics></math>.</li>
</ul>
<p>Similarly as for unstratified analysis,the 2-sided
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">100(1 - \alpha)</annotation></semantics></math>%
CI is given by the roots for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>D</mi><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mo>−</mo><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">PD = P_1 - P_0</annotation></semantics></math>,
and the bisection algorithm is used in the function to obtain the two
roots (confidence interval) for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">PD</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="p-value-and-z-statistic-1">p-value and Z-statistic<a class="anchor" aria-label="anchor" href="#p-value-and-z-statistic-1"></a>
</h4>
<p>The Z-statistic is computed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mtext mathvariant="normal">diff</mtext></msub><mo>=</mo><mfrac><mrow><msubsup><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>1</mn><mo>*</mo></msubsup><mo>−</mo><msubsup><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>0</mn><mo>*</mo></msubsup><mo>+</mo><msub><mi>S</mi><mn>0</mn></msub></mrow><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>W</mi><mi>i</mi></msub><mi>/</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>W</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msub><mover><mi>V</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">Z_\text{diff}=\frac{\hat{p}_1^*-\hat{p}^*_0+S_0}{\sqrt{\sum_{i=1}^I(W_i/\sum_{k=1}^{K}W_k)^2\tilde{V}_i}}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mn>0</mn></msub><annotation encoding="application/x-tex">S_0</annotation></semantics></math>
is pre-specified proportion difference under the null;</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\tilde{p}_{0i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\tilde{p}_{1i}</annotation></semantics></math>
are MLE for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">P_{0i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">P_{1i}</annotation></semantics></math>,
respectively, computed under the constraint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>=</mo><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>S</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\tilde{p}_{1i} = \tilde{p}_{0i} + S_0</annotation></semantics></math>.</li>
</ul>
<p>The p-value can be calculated as stated above.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="load-package">Load package<a class="anchor" aria-label="anchor" href="#load-package"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://merck.github.io/metalite.ae/">metalite.ae</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-simulation">Data simulation<a class="anchor" aria-label="anchor" href="#data-simulation"></a>
</h3>
<p>We simulated a dataset with 2 treatment group for binary output. If
stratum is used, we considered 4 stratum.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ana</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  response  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stratum   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">12</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">12</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ana</span><span class="op">)</span></span>
<span><span class="co">#&gt;   treatment response stratum</span></span>
<span><span class="co">#&gt; 1         0        0       1</span></span>
<span><span class="co">#&gt; 2         0        0       2</span></span>
<span><span class="co">#&gt; 3         0        0       3</span></span>
<span><span class="co">#&gt; 4         0        0       4</span></span>
<span><span class="co">#&gt; 5         0        0       1</span></span>
<span><span class="co">#&gt; 6         0        0       2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="unstratified-analysis">Unstratified analysis<a class="anchor" aria-label="anchor" href="#unstratified-analysis"></a>
</h3>
<p>The function computes the risk difference, Z-statistic, p-value given
the type of test, and two-sided
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">100(1 - \alpha)</annotation></semantics></math>%
confidence interval of difference between two rates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rate_compare.html">rate_compare</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">ana</span><span class="op">)</span></span>
<span><span class="co">#&gt;   est  z_score            p    lower     upper</span></span>
<span><span class="co">#&gt; 1 0.4 5.759051 4.229411e-09 0.269662 0.5165743</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="stratified-analysis">Stratified analysis<a class="anchor" aria-label="anchor" href="#stratified-analysis"></a>
</h3>
<p>The sample size weighting is often used in the clinical trial. Below
is the function to conduct stratified MN analysis with sample size
weights.</p>
<p>We also support weight in <code>"equal"</code> and
<code>"cmh"</code>. More details can be found in the
<code><a href="../reference/rate_compare.html">rate_compare()</a></code> documentation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rate_compare.html">rate_compare</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">response</span> <span class="op">~</span> <span class="va">treatment</span>, strata <span class="op">=</span> <span class="va">stratum</span>, data <span class="op">=</span> <span class="va">ana</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"ss"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;         est  z_score            p     lower     upper</span></span>
<span><span class="co">#&gt; 1 0.3998397 5.712797 5.556727e-09 0.2684383 0.5172779</span></span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-miettinen1985comparative" class="csl-entry">
Miettinen, Olli, and Markku Nurminen. 1985. <span>“Comparative Analysis
of Two Rates.”</span> <em>Statistics in Medicine</em> 4 (2): 213–26.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yilong Zhang, Yujie Zhao, Benjamin Wang, Nan Xiao, Sarad Nepal, Madhusudhan Ginnaram, Ruchitbhai Patel, Brian Lang, Xuan Deng, Hiroaki Fukuda, Bing Liu, Jeetender Chauhan. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1. <br>Copyright © 2024 Merck &amp; Co., Inc., Rahway, NJ, USA and its affiliates. All rights reserved.</p>
</div>

<div class="pkgdown-footer-right">
  <p><span></span></p>
</div>

    </footer>
</div>





  </body>
</html>
